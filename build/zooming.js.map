{"version":3,"file":null,"sources":["../src/_polyfill.js","../src/_helpers.js","../src/_options.js","../src/_style.js","../src/_trans.js","../src/_touch.js","../src/main.js"],"sourcesContent":["/* eslint-disable */\n/*\n * classList.js: Cross-browser full element.classList implementation.\n * 1.1.20170112\n *\n * By Eli Grey, http://eligrey.com\n * License: Dedicated to the public domain.\n *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */\n\nif (\"document\" in self) {\n\n// Full polyfill for browsers with no classList support\n// Including IE < Edge missing SVGElement.classList\nif (!(\"classList\" in document.createElement(\"_\")) \n\t|| document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n(function (view) {\n\n\"use strict\";\n\nif (!('Element' in view)) return;\n\nvar\n\t  classListProp = \"classList\"\n\t, protoProp = \"prototype\"\n\t, elemCtrProto = view.Element[protoProp]\n\t, objCtr = Object\n\t, strTrim = String[protoProp].trim || function () {\n\t\treturn this.replace(/^\\s+|\\s+$/g, \"\");\n\t}\n\t, arrIndexOf = Array[protoProp].indexOf || function (item) {\n\t\tvar\n\t\t\t  i = 0\n\t\t\t, len = this.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\t// Vendors: please allow content code to instantiate DOMExceptions\n\t, DOMEx = function (type, message) {\n\t\tthis.name = type;\n\t\tthis.code = DOMException[type];\n\t\tthis.message = message;\n\t}\n\t, checkTokenAndGetIndex = function (classList, token) {\n\t\tif (token === \"\") {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"SYNTAX_ERR\"\n\t\t\t\t, \"An invalid or illegal string was specified\"\n\t\t\t);\n\t\t}\n\t\tif (/\\s/.test(token)) {\n\t\t\tthrow new DOMEx(\n\t\t\t\t  \"INVALID_CHARACTER_ERR\"\n\t\t\t\t, \"String contains an invalid character\"\n\t\t\t);\n\t\t}\n\t\treturn arrIndexOf.call(classList, token);\n\t}\n\t, ClassList = function (elem) {\n\t\tvar\n\t\t\t  trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n\t\t\t, classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n\t\t\t, i = 0\n\t\t\t, len = classes.length\n\t\t;\n\t\tfor (; i < len; i++) {\n\t\t\tthis.push(classes[i]);\n\t\t}\n\t\tthis._updateClassName = function () {\n\t\t\telem.setAttribute(\"class\", this.toString());\n\t\t};\n\t}\n\t, classListProto = ClassList[protoProp] = []\n\t, classListGetter = function () {\n\t\treturn new ClassList(this);\n\t}\n;\n// Most DOMException implementations don't allow calling DOMException's toString()\n// on non-DOMExceptions. Error's toString() is sufficient here.\nDOMEx[protoProp] = Error[protoProp];\nclassListProto.item = function (i) {\n\treturn this[i] || null;\n};\nclassListProto.contains = function (token) {\n\ttoken += \"\";\n\treturn checkTokenAndGetIndex(this, token) !== -1;\n};\nclassListProto.add = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tif (checkTokenAndGetIndex(this, token) === -1) {\n\t\t\tthis.push(token);\n\t\t\tupdated = true;\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.remove = function () {\n\tvar\n\t\t  tokens = arguments\n\t\t, i = 0\n\t\t, l = tokens.length\n\t\t, token\n\t\t, updated = false\n\t\t, index\n\t;\n\tdo {\n\t\ttoken = tokens[i] + \"\";\n\t\tindex = checkTokenAndGetIndex(this, token);\n\t\twhile (index !== -1) {\n\t\t\tthis.splice(index, 1);\n\t\t\tupdated = true;\n\t\t\tindex = checkTokenAndGetIndex(this, token);\n\t\t}\n\t}\n\twhile (++i < l);\n\n\tif (updated) {\n\t\tthis._updateClassName();\n\t}\n};\nclassListProto.toggle = function (token, force) {\n\ttoken += \"\";\n\n\tvar\n\t\t  result = this.contains(token)\n\t\t, method = result ?\n\t\t\tforce !== true && \"remove\"\n\t\t:\n\t\t\tforce !== false && \"add\"\n\t;\n\n\tif (method) {\n\t\tthis[method](token);\n\t}\n\n\tif (force === true || force === false) {\n\t\treturn force;\n\t} else {\n\t\treturn !result;\n\t}\n};\nclassListProto.toString = function () {\n\treturn this.join(\" \");\n};\n\nif (objCtr.defineProperty) {\n\tvar classListPropDesc = {\n\t\t  get: classListGetter\n\t\t, enumerable: true\n\t\t, configurable: true\n\t};\n\ttry {\n\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t} catch (ex) { // IE 8 doesn't support enumerable:true\n\t\t// adding undefined to fight this issue https://github.com/eligrey/classList.js/issues/36\n\t\t// modernie IE8-MSW7 machine has IE8 8.0.6001.18702 and is affected\n\t\tif (ex.number === undefined || ex.number === -0x7FF5EC54) {\n\t\t\tclassListPropDesc.enumerable = false;\n\t\t\tobjCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n\t\t}\n\t}\n} else if (objCtr[protoProp].__defineGetter__) {\n\telemCtrProto.__defineGetter__(classListProp, classListGetter);\n}\n\n}(self));\n\n} else {\n// There is full or partial native classList support, so just check if we need\n// to normalize the add/remove and toggle APIs.\n\n(function () {\n\t\"use strict\";\n\n\tvar testElement = document.createElement(\"_\");\n\n\ttestElement.classList.add(\"c1\", \"c2\");\n\n\t// Polyfill for IE 10/11 and Firefox <26, where classList.add and\n\t// classList.remove exist but support only one argument at a time.\n\tif (!testElement.classList.contains(\"c2\")) {\n\t\tvar createMethod = function(method) {\n\t\t\tvar original = DOMTokenList.prototype[method];\n\n\t\t\tDOMTokenList.prototype[method] = function(token) {\n\t\t\t\tvar i, len = arguments.length;\n\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\ttoken = arguments[i];\n\t\t\t\t\toriginal.call(this, token);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\tcreateMethod('add');\n\t\tcreateMethod('remove');\n\t}\n\n\ttestElement.classList.toggle(\"c3\", false);\n\n\t// Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n\t// support the second argument.\n\tif (testElement.classList.contains(\"c3\")) {\n\t\tvar _toggle = DOMTokenList.prototype.toggle;\n\n\t\tDOMTokenList.prototype.toggle = function(token, force) {\n\t\t\tif (1 in arguments && !this.contains(token) === !force) {\n\t\t\t\treturn force;\n\t\t\t} else {\n\t\t\t\treturn _toggle.call(this, token);\n\t\t\t}\n\t\t};\n\n\t}\n\n\ttestElement = null;\n}());\n\n}\n\n}\n\n\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nObject.assign = function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","const body = document.body\nconst docElm = document.documentElement\nconst webkitPrefix = 'WebkitAppearance' in document.documentElement.style\n  ? '-webkit-'\n  : ''\n\nfunction on(elSelector, eventName, selector, handler, useCapture) {\n  const _useCapture = useCapture === undefined ? false : useCapture\n  let elements = null\n  if (typeof elSelector === 'string') {\n    elements = document.querySelectorAll(elSelector)\n  } else {\n    elements = [].concat(elSelector)\n  }\n  const addEventListener = function(element) {\n    element.addEventListener(eventName, function(e) {\n      for (let target = e.target; target && target !== this; target = target.parentNode) {\n        // loop parent nodes from the target to the delegation node\n        let match = false\n        if (target.matches) {\n          match = target.matches(selector)\n        } else if (target.webkitMatchesSelector) {\n          match = target.webkitMatchesSelector(selector)\n        } else if (target.mozMatchesSelector) {\n          match = target.mozMatchesSelector(selector)\n        } else if (target.msMatchesSelector) {\n          match = target.msMatchesSelector(selector)\n        } else if (target.oMatchesSelector) {\n          match = target.oMatchesSelector(selector)\n        }\n        if (match) {\n          handler.call(target, e)\n          break\n        }\n      }\n    }, _useCapture)\n  }\n  Array.prototype.forEach.call(elements, addEventListener)\n}\n\nconst divide = (denominator) => {\n  return (numerator) => {\n    return numerator / denominator\n  }\n}\n\nconst half = divide(2)\n\nconst loadImage = (url, cb) => {\n  const img = new Image()\n  img.onload = () => {\n    if (cb) cb(img)\n  }\n  img.src = url\n}\n\nconst scrollTop = () => {\n  return window.pageYOffset ||\n    (docElm || body.parentNode || body).scrollTop\n}\n\nconst getWindowCenter = () => {\n  const docWidth = docElm.clientWidth || body.clientWidth\n  const docHeight = docElm.clientHeight || body.clientHeight\n\n  return {\n    x: half(docWidth),\n    y: half(docHeight)\n  }\n}\n\nconst toggleListeners = (el, types, handler, add = true) => {\n  types.forEach(t => {\n    if (add) {\n      el.addEventListener(t, handler[t])\n    } else {\n      el.removeEventListener(t, handler[t])\n    }\n  })\n}\n\nconst detectIE = () => {\n  const ua = window.navigator.userAgent\n\n  // Test values; Uncomment to check result â€¦\n\n  // IE 10\n  // ua = 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)';\n  \n  // IE 11\n  // ua = 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko';\n  \n  // Edge 12 (Spartan)\n  // ua = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0';\n  \n  // Edge 13\n  // ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586';\n\n  const msie = ua.indexOf('MSIE ')\n  if (msie > 0) {\n    // IE 10 or older => return version number\n    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10)\n  }\n\n  const trident = ua.indexOf('Trident/')\n  if (trident > 0) {\n    // IE 11 => return version number\n    const rv = ua.indexOf('rv:')\n    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10)\n  }\n\n  const edge = ua.indexOf('Edge/')\n  if (edge > 0) {\n    // Edge (IE 12+) => return version number\n    return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10)\n  }\n\n  // other browser\n  return false\n} \n\n\nexport {\n  detectIE,\n  webkitPrefix,\n  half,\n  loadImage,\n  scrollTop,\n  getWindowCenter,\n  toggleListeners,\n  on\n}\n","/**\n * A list of options.\n *\n * @type {Object}\n * @example\n * // Default options\n * var options = {\n *   defaultZoomable: 'img[data-action=\"zoom\"]',\n *   enableGrab: true,\n *   preloadImage: true,\n *   transitionDuration: 0.4,\n *   transitionTimingFunction: 'cubic-bezier(0.4, 0, 0, 1)',\n *   bgColor: 'rgb(255, 255, 255)',\n *   bgOpacity: 1,\n *   scaleBase: 1.0,\n *   scaleExtra: 0.5,\n *   scrollThreshold: 40,\n *   onOpen: null,\n *   onClose: null,\n *   onRelease: null,\n *   onBeforeOpen: null,\n *   onBeforeClose: null,\n *   onBeforeGrab: null,\n *   onBeforeMove: null,\n *   onBeforeRelease: null,\n *   zIndex: 999\n * }\n */\nexport default {\n  /**\n   * Zoomable elements by default. It can be a css selector or an element.\n   * @type {string|Element}\n   */\n  defaultZoomable: 'img[data-action=\"zoom\"]',\n\n  /**\n   * To be able to grab and drag the image for extra zoom-in.\n   * @type {boolean}\n   */\n  enableGrab: true,\n\n  /**\n   * Preload images with attribute \"data-original\".\n   * @type {boolean}\n   */\n  preloadImage: true,\n\n  /**\n   * Transition duration in seconds.\n   * @type {number}\n   */\n  transitionDuration: 0.4,\n\n  /**\n   * Transition timing function.\n   * @type {string}\n   */\n  transitionTimingFunction: 'cubic-bezier(0.4, 0, 0, 1)',\n\n  /**\n   * Overlay background color.\n   * @type {string}\n   */\n  bgColor: 'rgb(255, 255, 255)',\n\n  /**\n   * Overlay background opacity.\n   * @type {number}\n   */\n  bgOpacity: 1,\n\n  /**\n   * z-index.\n   * @type {number}\n   */\n  zIndex: 998,\n\n  /**\n   * The base scale factor for zooming. By default scale to fit the window.\n   * @type {number}\n   */\n  scaleBase: 1.0,\n\n  /**\n   * The extra scale factor when grabbing the image.\n   * @type {number}\n   */\n  scaleExtra: 0.5,\n\n  /**\n   * How much scrolling it takes before closing out.\n   * @type {number}\n   */\n  scrollThreshold: 40,\n\n  /**\n   * A callback function that will be called when a target is opened and\n   * transition has ended. It will get the target element as the argument.\n   * @type {Function}\n   */\n  onOpen: null,\n\n  /**\n   * Same as above, except fired when closed.\n   * @type {Function}\n   */\n  onClose: null,\n\n  /**\n   * Same as above, except fired when released.\n   * @type {Function}\n   */\n  onRelease: null,\n\n  /**\n   * A callback function that will be called before open.\n   * @type {Function}\n   */\n  onBeforeOpen: null,\n\n  /**\n   * A callback function that will be called before close.\n   * @type {Function}\n   */\n  onBeforeClose: null,\n\n  /**\n   * A callback function that will be called before grab.\n   * @type {Function}\n   */\n  onBeforeGrab: null,\n\n  /**\n   * A callback function that will be called before move.\n   * @type {Function}\n   */\n  onBeforeMove: null,\n\n  /**\n   * A callback function that will be called before release.\n   * @type {Function}\n   */\n  onBeforeRelease: null,\n}\n","import { webkitPrefix } from './_helpers'\nimport options from './_options'\n\nexport default {\n  target: {\n    close: null,\n    open: null,\n  },\n  overlay: {\n    init: {\n      zIndex: options.zIndex,\n      backgroundColor: options.bgColor,\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      opacity: 0,\n      transition: `opacity\n        ${options.transitionDuration}s\n        ${options.transitionTimingFunction}`,\n    },\n  },\n  cursor: {\n    default: 'auto',\n    zoomIn: `${webkitPrefix}zoom-in`,\n    zoomOut: `${webkitPrefix}zoom-out`,\n    grab: `${webkitPrefix}grab`,\n    move: 'move',\n  },\n}\n","import { half, getWindowCenter } from './_helpers'\n\nconst sniffTransition = (el) => {\n  let ret     = {}\n  const trans = ['webkitTransition', 'mozTransition', 'oTransition', 'msTransition', 'transition']\n  const tform = ['webkitTransform', 'mozTransform', 'oTransform', 'msTransform', 'transform']\n  const end   = {\n    webkitTransition : 'webkitTransitionEnd',\n    mozTransition    : 'transitionend',\n    oTransition      : 'oTransitionEnd otransitionend',\n    msTransition     : 'msTransitionEnd',\n    transition       : 'transitionend'\n  }\n\n  trans.some(prop => {\n    if (el.style[prop] !== undefined) {\n      ret.transitionProp = prop\n      ret.transEndEvent = end[prop]\n      return true\n    }\n  })\n\n  tform.some(prop => {\n    if (el.style[prop] !== undefined) {\n      ret.transformProp = prop\n      ret.transformCssProp = prop.replace(/(.*)Transform/, '-$1-transform')\n      return true\n    }\n  })\n\n  return ret\n}\n\nconst checkTrans = (transitionProp, transformProp) => {\n  return function setStyle(el, styles, remember) {\n    let value\n    if (styles.transition) {\n      value = styles.transition\n      delete styles.transition\n      styles[transitionProp] = value\n    }\n    if (styles.transform) {\n      value = styles.transform\n      delete styles.transform\n      styles[transformProp] = value\n    }\n\n    let s = el.style\n    let original = {}\n\n    for (let key in styles) {\n      if (remember) original[key] = s[key] || ''\n      s[key] = styles[key]\n    }\n\n    return original\n  }\n}\n\nconst calculateTranslate = (rect) => {\n  const windowCenter = getWindowCenter()\n  const targetCenter = {\n    x: rect.left + half(rect.width),\n    y: rect.top + half(rect.height)\n  }\n\n  // The vector to translate image to the window center\n  return {\n    x: windowCenter.x - targetCenter.x,\n    y: windowCenter.y - targetCenter.y\n  }\n}\n\nconst calculateScale = (rect, scaleBase, windowCenter) => {\n  const targetHalfWidth = half(rect.width)\n  const targetHalfHeight = half(rect.height)\n\n  // The distance between target edge and window edge\n  const targetEdgeToWindowEdge = {\n    x: windowCenter.x - targetHalfWidth,\n    y: windowCenter.y - targetHalfHeight\n  }\n\n  const scaleHorizontally = targetEdgeToWindowEdge.x / targetHalfWidth\n  const scaleVertically = targetEdgeToWindowEdge.y / targetHalfHeight\n\n  // The additional scale is based on the smaller value of\n  // scaling horizontally and scaling vertically\n  return scaleBase + Math.min(scaleHorizontally, scaleVertically)\n}\n\nexport {\n  sniffTransition,\n  checkTrans,\n  calculateTranslate,\n  calculateScale\n}\n","import options from './_options'\n\nconst TOUCH_SCALE_FACTOR = 2\n\nconst processTouches = (touches, cb) => {\n  const total = touches.length\n  const firstTouch = touches[0]\n  const multitouch = total > 1\n\n  let scaleExtra = options.scaleExtra\n  let i = touches.length\n  let [xs, ys] = [0, 0]\n\n  // keep track of the min and max of touch positions\n  let min = { x: firstTouch.clientX, y: firstTouch.clientY }\n  let max = { x: firstTouch.clientX, y: firstTouch.clientY }\n\n  while (i--) {\n    const t = touches[i]\n    const [x, y] = [t.clientX, t.clientY]\n    xs += x\n    ys += y\n\n    if (!multitouch) continue\n\n    if (x < min.x) {\n      min.x = x\n    } else if (x > max.x) {\n      max.x = x\n    }\n\n    if (y < min.y) {\n      min.y = y\n    } else if (y > max.y) {\n      max.y = y\n    }\n  }\n\n  if (multitouch) {\n    // change scaleExtra dynamically\n    const [distX, distY] = [max.x - min.x, max.y - min.y]\n\n    if (distX > distY) {\n      scaleExtra = (distX / window.innerWidth) * TOUCH_SCALE_FACTOR\n    } else {\n      scaleExtra = (distY / window.innerHeight) * TOUCH_SCALE_FACTOR\n    }\n  }\n\n  cb(xs / total, ys / total, scaleExtra)\n}\n\nexport {\n  processTouches\n}\n","import './_polyfill'\nimport style from './_style'\nimport options from './_options'\nimport { loadImage, scrollTop, getWindowCenter, toggleListeners, on, detectIE } from './_helpers'\nimport { sniffTransition, checkTrans, calculateTranslate, calculateScale } from './_trans'\nimport { processTouches } from './_touch'\n\nconst PRESS_DELAY = 200\nconst EVENT_TYPES_GRAB = [\n  'mousedown',\n  'mousemove',\n  'mouseup',\n  'touchstart',\n  'touchmove',\n  'touchend',\n]\n\n// elements\nconst body = document.body\nconst overlay = document.createElement('div')\nlet target, parent\n\nconst isIE = detectIE()\n\n// state\nlet shown = false // target is open\nlet lock = false // target is in transform\nlet released = true // mouse/finger is not pressing down\nlet lastScrollPosition = null\nlet translate, scale, srcThumbnail, pressTimer\n\nconst trans = sniffTransition(overlay)\nconst transformCssProp = trans.transformCssProp\nconst transEndEvent = trans.transEndEvent\nconst setStyleHelper = checkTrans(trans.transitionProp, trans.transformProp)\n\nconst setStyle = (el, styles, remember) => {\n  return setStyleHelper(el, styles, remember)\n}\n\nconst eventHandler = {\n  click: function(e) {\n    e.preventDefault()\n\n    if (shown) {\n      if (released) api.close()\n      else api.release()\n    } else {\n      api.open(e.target)\n    }\n  },\n\n  scroll: function() {\n    const st = scrollTop()\n\n    if (lastScrollPosition === null) {\n      lastScrollPosition = st\n    }\n\n    const deltaY = lastScrollPosition - st\n\n    if (Math.abs(deltaY) >= options.scrollThreshold) {\n      lastScrollPosition = null\n      api.close()\n    }\n  },\n\n  keydown: function(e) {\n    const code = e.key || e.code\n    if (code === 'Escape' || e.keyCode === 27) {\n      if (released) api.close()\n      else api.release(() => api.close())\n    }\n  },\n\n  mousedown: function(e) {\n    if (e.button !== 0) return\n    e.preventDefault()\n\n    pressTimer = setTimeout(function() {\n      api.grab(e.clientX, e.clientY)\n    }, PRESS_DELAY)\n  },\n\n  mousemove: function(e) {\n    if (released) return\n    api.move(e.clientX, e.clientY)\n  },\n\n  mouseup: function(e) {\n    if (e.button !== 0) return\n    clearTimeout(pressTimer)\n\n    if (released) api.close()\n    else api.release()\n  },\n\n  touchstart: function(e) {\n    e.preventDefault()\n\n    pressTimer = setTimeout(() => {\n      processTouches(e.touches, (x, y, scaleExtra) => {\n        api.grab(x, y, scaleExtra)\n      })\n    }, PRESS_DELAY)\n  },\n\n  touchmove: function(e) {\n    if (released) return\n\n    processTouches(e.touches, (x, y, scaleExtra) => {\n      api.move(x, y, scaleExtra)\n    })\n  },\n\n  touchend: function(e) {\n    if (e.targetTouches.length > 0) return\n    clearTimeout(pressTimer)\n\n    if (released) api.close()\n    else api.release()\n  },\n}\n\nconst kabeCaseMap = {\n  bgOpacity: 'bg-opacity',\n}\n\nconst kabeCase = str => {\n  if (str in kabeCaseMap) return kabeCaseMap[str]\n\n  return str\n}\n\n/**\n * Zooming methods.\n * @type {Object}\n */\nconst api = {\n  /**\n   * Make element(s) zoomable.\n   * @param  {string|Element} el A css selector or an Element.\n   * @return {api}\n   */\n  listen: (el, delegated) => {\n    if (delegated) {\n      on(el, 'click', delegated, eventHandler.click)\n      return this\n    }\n\n    if (typeof el === 'string') {\n      let els = document.querySelectorAll(el),\n        i = els.length\n\n      while (i--) {\n        api.listen(els[i])\n      }\n\n      return this\n    }\n\n    if (el.tagName !== 'IMG') return\n\n    el.style.cursor = style.cursor.zoomIn\n\n    el.addEventListener('click', eventHandler.click)\n\n    if (options.preloadImage && el.hasAttribute('data-original')) {\n      loadImage(el.getAttribute('data-original'))\n    }\n\n    return this\n  },\n\n  /**\n   * Open (zoom in) the Element.\n   * @param  {Element} el The Element to open.\n   * @param  {Function} [cb=options.onOpen] A callback function that will be\n   * called when a target is opened and transition has ended. It will get\n   * the target element as the argument.\n   * @return {api}\n   */\n  open: (el, cb = options.onOpen) => {\n    if (shown || lock) return\n\n    target = typeof el === 'string' ? document.querySelector(el) : el\n\n    if (target.tagName !== 'IMG') return\n\n    const csutomOptions = Object.assign(options)\n\n    const overrideOption = ['bgOpacity' /*, scaleBase, duration */]\n    overrideOption.forEach(optKey => {\n      let value = null\n      if ((value = target.getAttribute(`data-${kabeCase(optKey)}`)) != null) {\n        csutomOptions[optKey] = value\n      }\n    })\n\n    const windowCenter = getWindowCenter()\n    // custom scale window\n    if (target.hasAttribute('data-width') && target.hasAttribute('data-height')) {\n      windowCenter.x = Math.min(windowCenter.x, target.getAttribute('data-width') / 2)\n      windowCenter.y = Math.min(windowCenter.y, target.getAttribute('data-height') / 2)\n    }\n\n    // onBeforeOpen event\n    if (csutomOptions.onBeforeOpen) csutomOptions.onBeforeOpen(target)\n\n    shown = true\n    lock = true\n    parent = target.parentNode\n\n    // load hi-res image if preloadImage option is disabled\n    if (!csutomOptions.preloadImage && target.hasAttribute('data-original')) {\n      loadImage(target.getAttribute('data-original'))\n    }\n\n    const rect = target.getBoundingClientRect()\n    translate = calculateTranslate(rect)\n    scale = calculateScale(rect, csutomOptions.scaleBase, windowCenter)\n\n    // force layout update\n    target.offsetWidth\n\n    const originalStyle = window.getComputedStyle(target)\n    style.target.open = {\n      position:\n        originalStyle.position && originalStyle.position !== 'static'\n          ? originalStyle.position\n          : 'relative',\n      zIndex: options.zIndex + 1,\n      cursor: csutomOptions.enableGrab ? style.cursor.grab : style.cursor.zoomOut,\n      transition: `${transformCssProp}\n        ${csutomOptions.transitionDuration}s\n        ${csutomOptions.transitionTimingFunction}`,\n      transform: `translate(${translate.x}px, ${translate.y}px) ${isIE\n        ? ''\n        : 'translateZ(0)'} scale(${scale})`,\n    }\n\n    // trigger transition\n    style.target.close = setStyle(target, style.target.open, true)\n\n    // insert overlay\n    parent.appendChild(overlay)\n    setTimeout(() => (overlay.style.opacity = csutomOptions.bgOpacity), 30)\n\n    document.addEventListener('scroll', eventHandler.scroll)\n    document.addEventListener('keydown', eventHandler.keydown)\n    const onEnd = () => {\n      target.classList.add('is-zoomed')\n\n      target.removeEventListener(transEndEvent, onEnd)\n\n      lock = false\n\n      if (csutomOptions.enableGrab) {\n        toggleListeners(document, EVENT_TYPES_GRAB, eventHandler, true)\n      }\n\n      if (target.hasAttribute('data-original')) {\n        srcThumbnail = target.getAttribute('src')\n        const dataOriginal = target.getAttribute('data-original')\n        const temp = target.cloneNode(false)\n\n        // force compute the hi-res image in DOM to prevent\n        // image flickering while updating src\n        temp.setAttribute('src', dataOriginal)\n        temp.style.position = 'fixed'\n        temp.style.visibility = 'hidden'\n        body.appendChild(temp)\n\n        setTimeout(() => {\n          target.setAttribute('src', dataOriginal)\n          body.removeChild(temp)\n        }, 10)\n      }\n\n      if (cb) cb(target)\n    }\n\n    if (transEndEvent) {\n      target.addEventListener(transEndEvent, onEnd)\n    } else {\n      onEnd()\n    }\n\n    return this\n  },\n\n  /**\n   * Close (zoom out) the Element currently opened.\n   * @param  {Function} [cb=options.onClose] A callback function that will be\n   * called when a target is closed and transition has ended. It will get\n   * the target element as the argument.\n   * @return {api}\n   */\n  close: (cb = options.onClose) => {\n    if (!shown || lock) return\n\n    // onBeforeClose event\n    if (options.onBeforeClose) options.onBeforeClose(target)\n\n    lock = true\n\n    // force layout update\n    target.offsetWidth\n\n    body.style.cursor = style.cursor.default\n    overlay.style.opacity = 0\n    setStyle(target, { transform: 'none' })\n\n    document.removeEventListener('scroll', eventHandler.scroll)\n    document.removeEventListener('keydown', eventHandler.keydown)\n\n    const onEnd = () => {\n      target.classList.remove('is-zoomed')\n      target.removeEventListener(transEndEvent, onEnd)\n\n      shown = false\n      lock = false\n\n      if (options.enableGrab) {\n        toggleListeners(document, EVENT_TYPES_GRAB, eventHandler, false)\n      }\n\n      if (target.hasAttribute('data-original')) {\n        // downgrade source\n        target.setAttribute('src', srcThumbnail)\n      }\n\n      // trigger transition\n      setStyle(target, style.target.close)\n\n      // remove overlay\n      parent.removeChild(overlay)\n\n      if (cb) cb(target)\n    }\n\n    if (transEndEvent) {\n      target.addEventListener(transEndEvent, onEnd)\n    } else {\n      onEnd()\n    }\n\n    return this\n  },\n\n  /**\n   * Grab the Element currently opened given a position and apply extra zoom-in.\n   * @param  {number}   x The X-axis of where the press happened.\n   * @param  {number}   y The Y-axis of where the press happened.\n   * @param  {number}   scaleExtra Extra zoom-in to apply.\n   * @param  {Function} [cb=options.scaleExtra] A callback function that will be\n   * called when a target is grabbed and transition has ended. It will get\n   * the target element as the argument.\n   * @return {api}\n   */\n  grab: (x, y, scaleExtra = options.scaleExtra, cb) => {\n    if (!shown || lock) return\n\n    // onBeforeGrab event\n    if (options.onBeforeGrab) options.onBeforeGrab(target)\n\n    released = false\n\n    const windowCenter = getWindowCenter()\n    const [dx, dy] = [windowCenter.x - x, windowCenter.y - y]\n\n    setStyle(target, {\n      cursor: style.cursor.move,\n      transform: `translate(${translate.x + dx}px, ${translate.y + dy}px)\n        scale(${scale + scaleExtra})`,\n    })\n\n    target.addEventListener(transEndEvent, function onEnd() {\n      target.removeEventListener(transEndEvent, onEnd)\n      if (cb) cb(target)\n    })\n  },\n\n  /**\n   * Move the Element currently grabbed given a position and apply extra zoom-in.\n   * @param  {number}   x The X-axis of where the press happened.\n   * @param  {number}   y The Y-axis of where the press happened.\n   * @param  {number}   scaleExtra Extra zoom-in to apply.\n   * @param  {Function} [cb=options.scaleExtra] A callback function that will be\n   * called when a target is moved and transition has ended. It will get\n   * the target element as the argument.\n   * @return {api}\n   */\n  move: (x, y, scaleExtra = options.scaleExtra, cb) => {\n    if (!shown || lock) return\n\n    // onBeforeMove event\n    if (options.onBeforeMove) options.onBeforeMove(target)\n\n    released = false\n\n    const windowCenter = getWindowCenter()\n    const [dx, dy] = [windowCenter.x - x, windowCenter.y - y]\n\n    setStyle(target, {\n      transition: transformCssProp,\n      transform: `translate(${translate.x + dx}px, ${translate.y + dy}px)\n        scale(${scale + scaleExtra})`,\n    })\n\n    body.style.cursor = style.cursor.move\n\n    target.addEventListener(transEndEvent, function onEnd() {\n      target.removeEventListener(transEndEvent, onEnd)\n      if (cb) cb(target)\n    })\n  },\n\n  /**\n   * Release the Element currently grabbed.\n   * @param  {Function} [cb=options.onRelease] A callback function that will be\n   * called when a target is released and transition has ended. It will get\n   * the target element as the argument.\n   * @return {api}\n   */\n  release: (cb = options.onRelease) => {\n    if (!shown || lock) return\n\n    // onBeforeRelease event\n    if (options.onBeforeRelease) options.onBeforeRelease(target)\n\n    lock = true\n\n    setStyle(target, style.target.open)\n    body.style.cursor = style.cursor.default\n\n    target.addEventListener(transEndEvent, function onEnd() {\n      target.removeEventListener(transEndEvent, onEnd)\n\n      lock = false\n      released = true\n\n      if (cb) cb(target)\n    })\n\n    return this\n  },\n\n  /**\n   * Update options.\n   * @param  {Object} opts An Object that contains options.\n   * @return {api}\n   */\n  config: opts => {\n    if (!opts) return options\n\n    for (let key in opts) {\n      options[key] = opts[key]\n    }\n\n    setStyle(overlay, {\n      zIndex: options.zIndex,\n      backgroundColor: options.bgColor,\n      transition: `opacity\n        ${options.transitionDuration}s\n        ${options.transitionTimingFunction}`,\n    })\n\n    return this\n  },\n}\n\n// Init ------------------------------------------------------------------------\n\nsetStyle(overlay, style.overlay.init)\noverlay.setAttribute('id', 'zoom-overlay')\noverlay.addEventListener('click', () => api.close())\ndocument.addEventListener('DOMContentLoaded', () => {\n  api.listen(options.defaultZoomable)\n})\n\nexport default api\n"],"names":["self","document","createElement","createElementNS","view","classListProp","protoProp","elemCtrProto","Element","objCtr","Object","strTrim","String","trim","replace","arrIndexOf","Array","indexOf","item","i","len","length","DOMEx","type","message","name","code","DOMException","checkTokenAndGetIndex","classList","token","test","call","ClassList","elem","trimmedClasses","getAttribute","classes","split","push","_updateClassName","setAttribute","toString","classListProto","classListGetter","Error","contains","add","tokens","arguments","l","updated","remove","index","splice","toggle","force","result","method","join","defineProperty","classListPropDesc","ex","number","undefined","enumerable","__defineGetter__","testElement","createMethod","original","DOMTokenList","prototype","_toggle","getOwnPropertySymbols","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","toObject","val","TypeError","assign","target","source","from","to","symbols","s","key","body","docElm","documentElement","webkitPrefix","style","on","elSelector","eventName","selector","handler","useCapture","_useCapture","elements","querySelectorAll","concat","addEventListener","element","e","parentNode","match","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","forEach","divide","denominator","numerator","half","loadImage","url","cb","img","Image","onload","src","scrollTop","window","pageYOffset","getWindowCenter","docWidth","clientWidth","docHeight","clientHeight","toggleListeners","el","types","t","removeEventListener","detectIE","ua","navigator","userAgent","msie","parseInt","substring","trident","rv","edge","options","zIndex","bgColor","transitionDuration","transitionTimingFunction","sniffTransition","ret","trans","tform","end","some","prop","transitionProp","transEndEvent","transformProp","transformCssProp","checkTrans","setStyle","styles","remember","value","transition","transform","calculateTranslate","rect","windowCenter","targetCenter","left","width","top","height","x","y","calculateScale","scaleBase","targetHalfWidth","targetHalfHeight","targetEdgeToWindowEdge","scaleHorizontally","scaleVertically","Math","min","TOUCH_SCALE_FACTOR","processTouches","touches","total","firstTouch","multitouch","scaleExtra","xs","ys","clientX","clientY","max","distX","distY","innerWidth","innerHeight","PRESS_DELAY","EVENT_TYPES_GRAB","overlay","parent","isIE","shown","lock","released","lastScrollPosition","translate","scale","srcThumbnail","pressTimer","setStyleHelper","eventHandler","preventDefault","api","close","release","open","st","deltaY","abs","scrollThreshold","keyCode","button","setTimeout","grab","move","targetTouches","kabeCaseMap","kabeCase","str","delegated","click","els","listen","tagName","cursor","zoomIn","preloadImage","hasAttribute","onOpen","querySelector","csutomOptions","overrideOption","optKey","onBeforeOpen","getBoundingClientRect","offsetWidth","originalStyle","getComputedStyle","position","enableGrab","zoomOut","appendChild","opacity","bgOpacity","scroll","keydown","onEnd","dataOriginal","temp","cloneNode","visibility","removeChild","onClose","onBeforeClose","default","onBeforeGrab","dx","dy","onBeforeMove","onRelease","onBeforeRelease","opts","init","defaultZoomable"],"mappings":"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"}