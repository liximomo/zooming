!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Zooming=t()}(this,function(){"use strict";function e(e,t,n,o,r){var i=void 0!==r&&r,a=null;a="string"==typeof e?document.querySelectorAll(e):[].concat(e);var s=function(e){e.addEventListener(t,function(e){for(var t=e.target;t&&t!==this;t=t.parentNode){var r=!1;if(t.matches?r=t.matches(n):t.webkitMatchesSelector?r=t.webkitMatchesSelector(n):t.mozMatchesSelector?r=t.mozMatchesSelector(n):t.msMatchesSelector?r=t.msMatchesSelector(n):t.oMatchesSelector&&(r=t.oMatchesSelector(n)),r){o.call(t,e);break}}},i)};Array.prototype.forEach.call(a,s)}var t=document.body,n=document.documentElement,o="WebkitAppearance"in document.documentElement.style?"-webkit-":"",r=function(e){return function(t){return t/e}},i=r(2),a=function(e,t){var n=new Image;n.onload=function(){t&&t(n)},n.src=e},s=function(){return window.pageYOffset||(n||t.parentNode||t).scrollTop},c=function(){var e=n.clientWidth||t.clientWidth,o=n.clientHeight||t.clientHeight;return{x:i(e),y:i(o)}},l=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.forEach(function(t){o?e.addEventListener(t,n[t]):e.removeEventListener(t,n[t])})},u={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeMove:null,onBeforeRelease:null},d={target:{close:null,open:null},overlay:{init:{zIndex:998,backgroundColor:u.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n        "+u.transitionDuration+"s\n        "+u.transitionTimingFunction}},cursor:{default:"auto",zoomIn:o+"zoom-in",zoomOut:o+"zoom-out",grab:o+"grab",move:"move"}},f=function(e){var t={},n=["webkitTransition","mozTransition","msTransition","transition"],o=["webkitTransform","mozTransform","msTransform","transform"],r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};return n.some(function(n){if(void 0!==e.style[n])return t.transitionProp=n,t.transEndEvent=r[n],!0}),o.some(function(n){if(void 0!==e.style[n])return t.transformProp=n,t.transformCssProp=n.replace(/(.*)Transform/,"-$1-transform"),!0}),t},m=function(e,t){return function(n,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[t]=i);var a=n.style,s={};for(var c in o)r&&(s[c]=a[c]||""),a[c]=o[c];return s}},v=function(e){var t=c(),n={x:e.left+i(e.width),y:e.top+i(e.height)};return{x:t.x-n.x,y:t.y-n.y}},g=function(e,t,n){var o=i(e.width),r=i(e.height),a={x:n.x-o,y:n.y-r},s=a.x/o,c=a.y/r;return t+Math.min(s,c)},h=2,p=function(e,t){for(var n=e.length,o=e[0],r=n>1,i=u.scaleExtra,a=e.length,s=0,c=0,l={x:o.clientX,y:o.clientY},d={x:o.clientX,y:o.clientY};a--;){var f=e[a],m=[f.clientX,f.clientY],v=m[0],g=m[1];s+=v,c+=g,r&&(v<l.x?l.x=v:v>d.x&&(d.x=v),g<l.y?l.y=g:g>d.y&&(d.y=g))}if(r){var p=d.x-l.x,y=d.y-l.y;i=p>y?p/window.innerWidth*h:y/window.innerHeight*h}t(s/n,c/n,i)},y=void 0,b=200,x=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],E=document.body,w=document.createElement("div"),T=void 0,k=void 0,L=!1,A=!1,C=!0,M=null,z=void 0,B=void 0,O=void 0,S=void 0,I=f(w),G=I.transformCssProp,D=I.transEndEvent,W=m(I.transitionProp,I.transformProp),N=function(e,t,n){return W(e,t,n)},P={click:function(e){e.preventDefault(),L?C?X.close():X.release():X.open(e.target)},scroll:function(){var e=s();null===M&&(M=e);var t=M-e;Math.abs(t)>=u.scrollThreshold&&(M=null,X.close())},keydown:function(e){var t=e.key||e.code;"Escape"!==t&&27!==e.keyCode||(C?X.close():X.release(function(){return X.close()}))},mousedown:function(e){0===e.button&&(e.preventDefault(),S=setTimeout(function(){X.grab(e.clientX,e.clientY)},b))},mousemove:function(e){C||X.move(e.clientX,e.clientY)},mouseup:function(e){0===e.button&&(clearTimeout(S),C?X.close():X.release())},touchstart:function(e){e.preventDefault(),S=setTimeout(function(){p(e.touches,function(e,t,n){X.grab(e,t,n)})},b)},touchmove:function(e){C||p(e.touches,function(e,t,n){X.move(e,t,n)})},touchend:function(e){e.targetTouches.length>0||(clearTimeout(S),C?X.close():X.release())}},R={bgOpacity:"bg-opacity"},Y=function(e){return e in R?R[e]:e},X={listen:function(t,n){if(n&&e(t,"click",n,P.click),"string"==typeof t){for(var o=document.querySelectorAll(t),r=o.length;r--;)X.listen(o[r]);return y}if("IMG"===t.tagName)return t.style.cursor=d.cursor.zoomIn,t.addEventListener("click",P.click),u.preloadImage&&t.hasAttribute("data-original")&&a(t.getAttribute("data-original")),y},open:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.onOpen;if(!L&&!A&&(T="string"==typeof e?document.querySelector(e):e,"IMG"===T.tagName)){var n=Object.assign(u),o=["bgOpacity"];o.forEach(function(e){var t=null;null!=(t=T.getAttribute("data-"+Y(e)))&&(n[e]=t)});var r=c();T.hasAttribute("data-width")&&T.hasAttribute("data-height")&&(r.x=Math.min(r.x,T.getAttribute("data-width")/2),r.y=Math.min(r.y,T.getAttribute("data-height")/2)),n.onBeforeOpen&&n.onBeforeOpen(T),L=!0,A=!0,k=T.parentNode,!n.preloadImage&&T.hasAttribute("data-original")&&a(T.getAttribute("data-original"));var i=T.getBoundingClientRect();z=v(i),B=g(i,n.scaleBase,r),T.offsetWidth;var s=window.getComputedStyle(T);d.target.open={position:s.position||"relative",zIndex:999,cursor:n.enableGrab?d.cursor.grab:d.cursor.zoomOut,transition:G+"\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction,transform:"translate("+z.x+"px, "+z.y+"px) scale("+B+")"},d.target.close=N(T,d.target.open,!0),k.appendChild(w),setTimeout(function(){return w.style.opacity=n.bgOpacity},30),document.addEventListener("scroll",P.scroll),document.addEventListener("keydown",P.keydown);var f=function e(){T.classList.add("is-zoomed"),T.removeEventListener(D,e),A=!1,n.enableGrab&&l(document,x,P,!0),T.hasAttribute("data-original")&&!function(){O=T.getAttribute("src");var e=T.getAttribute("data-original"),t=T.cloneNode(!1);t.setAttribute("src",e),t.style.position="fixed",t.style.visibility="hidden",E.appendChild(t),setTimeout(function(){T.setAttribute("src",e),E.removeChild(t)},10)}(),t&&t(T)};return D?T.addEventListener(D,f):f(),y}},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.onClose;if(L&&!A){u.onBeforeClose&&u.onBeforeClose(T),A=!0,T.offsetWidth,E.style.cursor=d.cursor.default,w.style.opacity=0,N(T,{transform:"none"}),document.removeEventListener("scroll",P.scroll),document.removeEventListener("keydown",P.keydown);var t=function t(){T.classList.remove("is-zoomed"),T.removeEventListener(D,t),L=!1,A=!1,u.enableGrab&&l(document,x,P,!1),T.hasAttribute("data-original")&&T.setAttribute("src",O),N(T,d.target.close),k.removeChild(w),e&&e(T)};return D?T.addEventListener(D,t):t(),y}},grab:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.scaleExtra,o=arguments[3];if(L&&!A){u.onBeforeGrab&&u.onBeforeGrab(T),C=!1;var r=c(),i=r.x-e,a=r.y-t;N(T,{cursor:d.cursor.move,transform:"translate("+(z.x+i)+"px, "+(z.y+a)+"px)\n        scale("+(B+n)+")"}),T.addEventListener(D,function e(){T.removeEventListener(D,e),o&&o(T)})}},move:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.scaleExtra,o=arguments[3];if(L&&!A){u.onBeforeMove&&u.onBeforeMove(T),C=!1;var r=c(),i=r.x-e,a=r.y-t;N(T,{transition:G,transform:"translate("+(z.x+i)+"px, "+(z.y+a)+"px)\n        scale("+(B+n)+")"}),E.style.cursor=d.cursor.move,T.addEventListener(D,function e(){T.removeEventListener(D,e),o&&o(T)})}},release:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.onRelease;if(L&&!A)return u.onBeforeRelease&&u.onBeforeRelease(T),A=!0,N(T,d.target.open),E.style.cursor=d.cursor.default,T.addEventListener(D,function t(){T.removeEventListener(D,t),A=!1,C=!0,e&&e(T)}),y},config:function(e){if(!e)return u;for(var t in e)u[t]=e[t];return N(w,{backgroundColor:u.bgColor,transition:"opacity\n        "+u.transitionDuration+"s\n        "+u.transitionTimingFunction}),y}};return N(w,d.overlay.init),w.setAttribute("id","zoom-overlay"),w.addEventListener("click",function(){return X.close()}),document.addEventListener("DOMContentLoaded",function(){X.listen(u.defaultZoomable)}),X});
//# sourceMappingURL=zooming.min.js.map
