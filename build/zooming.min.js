!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Zooming=t()}(this,function(){"use strict";function e(e,t,n,o,r){var i=void 0!==r&&r,a=null;a="string"==typeof e?document.querySelectorAll(e):[].concat(e);var s=function(e){e.addEventListener(t,function(e){for(var t=e.target;t&&t!==this;t=t.parentNode){var r=!1;if(t.matches?r=t.matches(n):t.webkitMatchesSelector?r=t.webkitMatchesSelector(n):t.mozMatchesSelector?r=t.mozMatchesSelector(n):t.msMatchesSelector?r=t.msMatchesSelector(n):t.oMatchesSelector&&(r=t.oMatchesSelector(n)),r){o.call(t,e);break}}},i)};Array.prototype.forEach.call(a,s)}var t=document.body,n=document.documentElement,o="WebkitAppearance"in document.documentElement.style?"-webkit-":"",r=function(e){return function(t){return t/e}},i=r(2),a=function(e,t){var n=new Image;n.onload=function(){t&&t(n)},n.src=e},s=function(){return window.pageYOffset||(n||t.parentNode||t).scrollTop},c=function(){var e=n.clientWidth||t.clientWidth,o=n.clientHeight||t.clientHeight;return{x:i(e),y:i(o)}},l=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t.forEach(function(t){o?e.addEventListener(t,n[t]):e.removeEventListener(t,n[t])})},u={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeMove:null,onBeforeRelease:null},d={target:{close:null,open:null},overlay:{init:{zIndex:998,backgroundColor:u.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n        "+u.transitionDuration+"s\n        "+u.transitionTimingFunction}},cursor:{default:"auto",zoomIn:o+"zoom-in",zoomOut:o+"zoom-out",grab:o+"grab",move:"move"}},f=function(e){var t={},n=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return n.some(function(n){if(void 0!==e.style[n])return t.transitionProp=n,t.transEndEvent=r[n],!0}),o.some(function(n){if(void 0!==e.style[n])return t.transformProp=n,t.transformCssProp=n.replace(/(.*)Transform/,"-$1-transform"),!0}),t},m=function(e,t){return function(n,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[t]=i);var a=n.style,s={};for(var c in o)r&&(s[c]=a[c]||""),a[c]=o[c];return s}},v=function(e){var t=c(),n={x:e.left+i(e.width),y:e.top+i(e.height)};return{x:t.x-n.x,y:t.y-n.y}},g=function(e,t,n){var o=i(e.width),r=i(e.height),a={x:n.x-o,y:n.y-r},s=a.x/o,c=a.y/r;return t+Math.min(s,c)},h=2,p=function(e,t){for(var n=e.length,o=e[0],r=n>1,i=u.scaleExtra,a=e.length,s=0,c=0,l={x:o.clientX,y:o.clientY},d={x:o.clientX,y:o.clientY};a--;){var f=e[a],m=[f.clientX,f.clientY],v=m[0],g=m[1];s+=v,c+=g,r&&(v<l.x?l.x=v:v>d.x&&(d.x=v),g<l.y?l.y=g:g>d.y&&(d.y=g))}if(r){var p=d.x-l.x,y=d.y-l.y;i=p>y?p/window.innerWidth*h:y/window.innerHeight*h}t(s/n,c/n,i)},y=void 0,b=200,x=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],E=document.body,w=document.createElement("div"),k=void 0,L=void 0,T=!1,A=!1,C=!0,z=null,B=void 0,M=void 0,O=void 0,S=void 0,I=f(w),G=I.transformCssProp,D=I.transEndEvent,N=m(I.transitionProp,I.transformProp),P=function(e,t,n){return N(e,t,n)},R={click:function(e){e.preventDefault(),T?C?X.close():X.release():X.open(e.target)},scroll:function(){var e=s();null===z&&(z=e);var t=z-e;Math.abs(t)>=u.scrollThreshold&&(z=null,X.close())},keydown:function(e){var t=e.key||e.code;"Escape"!==t&&27!==e.keyCode||(C?X.close():X.release(function(){return X.close()}))},mousedown:function(e){0===e.button&&(e.preventDefault(),S=setTimeout(function(){X.grab(e.clientX,e.clientY)},b))},mousemove:function(e){C||X.move(e.clientX,e.clientY)},mouseup:function(e){0===e.button&&(clearTimeout(S),C?X.close():X.release())},touchstart:function(e){e.preventDefault(),S=setTimeout(function(){p(e.touches,function(e,t,n){X.grab(e,t,n)})},b)},touchmove:function(e){C||p(e.touches,function(e,t,n){X.move(e,t,n)})},touchend:function(e){e.targetTouches.length>0||(clearTimeout(S),C?X.close():X.release())}},W={bgOpacity:"bg-opacity"},Y=function(e){return e in W?W[e]:e},X={listen:function(t,n){if(n&&e(t,"click",n,R.click),"string"==typeof t){for(var o=document.querySelectorAll(t),r=o.length;r--;)X.listen(o[r]);return y}if("IMG"===t.tagName)return t.style.cursor=d.cursor.zoomIn,t.addEventListener("click",R.click),u.preloadImage&&t.hasAttribute("data-original")&&a(t.getAttribute("data-original")),y},open:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.onOpen;if(!T&&!A&&(k="string"==typeof e?document.querySelector(e):e,"IMG"===k.tagName)){var n=Object.assign(u),o=["bgOpacity"];o.forEach(function(e){var t=null;null!=(t=k.getAttribute("data-"+Y(e)))&&(n[e]=t)});var r=c();k.hasAttribute("data-width")&&k.hasAttribute("data-height")&&(r.x=Math.min(r.x,k.getAttribute("data-width")/2),r.y=Math.min(r.y,k.getAttribute("data-height")/2)),n.onBeforeOpen&&n.onBeforeOpen(k),T=!0,A=!0,L=k.parentNode,!n.preloadImage&&k.hasAttribute("data-original")&&a(k.getAttribute("data-original"));var i=k.getBoundingClientRect();B=v(i),M=g(i,n.scaleBase,r),k.offsetWidth;var s=window.getComputedStyle(k);return d.target.open={position:s.position||"relative",zIndex:999,cursor:n.enableGrab?d.cursor.grab:d.cursor.zoomOut,transition:G+"\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction,transform:"translate("+B.x+"px, "+B.y+"px) translateZ(0) scale("+M+")"},d.target.close=P(k,d.target.open,!0),L.appendChild(w),setTimeout(function(){return w.style.opacity=n.bgOpacity},30),document.addEventListener("scroll",R.scroll),document.addEventListener("keydown",R.keydown),k.addEventListener(D,function e(){k.classList.add("is-zoomed"),k.removeEventListener(D,e),A=!1,n.enableGrab&&l(document,x,R,!0),k.hasAttribute("data-original")&&!function(){O=k.getAttribute("src");var e=k.getAttribute("data-original"),t=k.cloneNode(!1);t.setAttribute("src",e),t.style.position="fixed",t.style.visibility="hidden",E.appendChild(t),setTimeout(function(){k.setAttribute("src",e),E.removeChild(t)},10)}(),t&&t(k)}),y}},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.onClose;if(T&&!A)return u.onBeforeClose&&u.onBeforeClose(k),A=!0,k.offsetWidth,E.style.cursor=d.cursor.default,w.style.opacity=0,P(k,{transform:"none"}),document.removeEventListener("scroll",R.scroll),document.removeEventListener("keydown",R.keydown),k.addEventListener(D,function t(){k.classList.remove("is-zoomed"),k.removeEventListener(D,t),T=!1,A=!1,u.enableGrab&&l(document,x,R,!1),k.hasAttribute("data-original")&&k.setAttribute("src",O),P(k,d.target.close),L.removeChild(w),e&&e(k)}),y},grab:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.scaleExtra,o=arguments[3];if(T&&!A){u.onBeforeGrab&&u.onBeforeGrab(k),C=!1;var r=c(),i=r.x-e,a=r.y-t;P(k,{cursor:d.cursor.move,transform:"translate("+(B.x+i)+"px, "+(B.y+a)+"px)\n        scale("+(M+n)+")"}),k.addEventListener(D,function e(){k.removeEventListener(D,e),o&&o(k)})}},move:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.scaleExtra,o=arguments[3];if(T&&!A){u.onBeforeMove&&u.onBeforeMove(k),C=!1;var r=c(),i=r.x-e,a=r.y-t;P(k,{transition:G,transform:"translate("+(B.x+i)+"px, "+(B.y+a)+"px)\n        scale("+(M+n)+")"}),E.style.cursor=d.cursor.move,k.addEventListener(D,function e(){k.removeEventListener(D,e),o&&o(k)})}},release:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.onRelease;if(T&&!A)return u.onBeforeRelease&&u.onBeforeRelease(k),A=!0,P(k,d.target.open),E.style.cursor=d.cursor.default,k.addEventListener(D,function t(){k.removeEventListener(D,t),A=!1,C=!0,e&&e(k)}),y},config:function(e){if(!e)return u;for(var t in e)u[t]=e[t];return P(w,{backgroundColor:u.bgColor,transition:"opacity\n        "+u.transitionDuration+"s\n        "+u.transitionTimingFunction}),y}};return P(w,d.overlay.init),w.setAttribute("id","zoom-overlay"),w.addEventListener("click",function(){return X.close()}),document.addEventListener("DOMContentLoaded",function(){X.listen(u.defaultZoomable)}),X});
//# sourceMappingURL=zooming.min.js.map
